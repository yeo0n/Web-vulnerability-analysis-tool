import sys
import time
import subprocess

def num1():
    # Reflected XSS [ 반사된 XSS 진단 시작 ]
    print("\n Reflected XSS 취약점 진단을 시작합니다. \n")
    subprocess.run(["python", "XSS/main.py"])

def num2():
    # Stored XSS [ 저장된 XSS 진단 시작 ]
    print("\n Stored XSS 취약점 진단을 시작합니다. \n")
    subprocess.run(["python", "StoredXSS/main.py"])

def num3():
    # DOM XSS [ DOM 베이스 XSS 진단 시작 ]
    print("\n DOM Based XSS 취약점 진단을 시작합니다. \n")
    subprocess.run(["python", "DOM XSS/main.py"])

def num4():
    # DOM XSS [ SQL 인젝션 진단 시작 ]
    print("\n Normal SQLi 취약점 진단을 시작합니다. \n")
    subprocess.run(["python", "Normal SQLi/normal_sqli2.py"])

def num5():
    # DOM XSS [ 블라인드 SQL 인젝션 진단 시작 ]
    print("\n Blind SQLi 취약점 진단을 시작합니다. \n")
    #subprocess.run(["python", "여기에 경로 입력"])

print("\n")
print("=========================================================================================================")
print("-> \033[33m크로스 사이트 스크립팅 (XSS)\033[0m 이란? <-")
print("사용자가 웹사이트와 상호작용할 때 비정상적인 상황을 발생시킵니다.")
print("이는 또한 \033[38;2;255;0;0m공격자\033[0m가 피해자 사용자로 가장하여 사용자의 권한을 갖고 권한 내의 피해를 발생시킬 수 있습니다.")
print("쉽게 말해서 \033[38;2;255;0;0m공격자\033[0m가 사용자의 권한을 갖고 모든 기능과 데이터에 대한 제어권을 얻어낼 수 있습니다.")

print("\n")
print("-> \033[33mSQL 인젝션 (SQLi)\033[0m 이란? <-")
print("웹사이트가 데이터베이스에 상호작용 할 때 방해할 수 있는 보안 취약점입니다.")
print("쉽게 말해서 \033[38;2;255;0;0m공격자\033[0m가 데이터를 가지고 수정하거나 삭제하거나 기밀 문서를 유출할 수 있습니다.")
print("=========================================================================================================")

while(True):
    
    print("\n 원하는 취약점 진단 분야를 선택해주세요.")
    print("(보기의 ALL은 해당 취약점의 종류를 모두 검사합니다.)")
    time.sleep(1)

    print("┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓")
    print("┃     1. Reflected XSS       ┃")
    print("┃     2. Stored XSS          ┃")
    print("┃     3. DOM XSS             ┃")
    print("┃     4. Normal SQLi         ┃")
    print("┃     5. Blind SQLi          ┃")
    print("┠━━━━━━━━━━━━━━━━━━━━━━━━━━━━┨")
    print("┃     6. ALL XSS             ┃")
    print("┃     7. ALL SQLi            ┃")
    print("┃     8. ALL SCAN            ┃")
    print("┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛")
    print("\n")
    print(" \033[33m메인메뉴로 돌아가고 싶다면 0 을 입력해주세요 \033[0m")
        
        
        
    try :
        choiceMenu = int(input("\n번호 선택 : "))
        if choiceMenu == 1:
            # 1번 선택
            num1()
        elif choiceMenu == 2:
            # 2번 선택
            num2()
        elif choiceMenu == 3:
            # 3번 선택
            num3()
        elif choiceMenu == 4:
            # 4번 선택
            num4()
        elif choiceMenu == 5:
            # 5번 선택
            num5()
        elif choiceMenu == 6:
            # 6번 선택
            num1()
            num2()
            num3()
        elif choiceMenu == 7:
            # 7번 선택
            num4()
            num5()
        elif choiceMenu == 8:
            # 8번 선택
            num1()
            num2()
            num3()
            num4()
            num5()
        elif choiceMenu == 0:
            #0 프로그램 종료
            print("\n프로그램을 종료합니다.\n")
            break
        else:
            print("\n잘못된 번호를 입력했습니다.\n")
            time.sleep(1)
    except ValueError :
        print("\n숫자를 입력해주세요.\n")
        time.sleep(1)
